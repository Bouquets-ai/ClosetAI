<view class="container">
  <!-- å¤´éƒ¨åŒºåŸŸ -->
  <view class="header">
    <view class="title">ä¸ä¼šç©¿æ­</view>
    <!-- ä¿¡æ¯å±•ç¤ºåŒºåŸŸ -->
     <view class="info-container">
       <!-- ä¸»è¦ä¿¡æ¯æ¡ -->
       <view class="main-info-bar">
         <view class="info-section date-section">
           <view class="info-icon">ğŸ“…</view>
           <view class="info-content">
             <view class="info-title">ä»Šæ—¥</view>
             <view class="info-text">{{currentDate}}</view>
           </view>
         </view>
         
         <view class="info-section weather-section" wx:if="{{weather}}">
           <view class="info-icon">{{weather.icon}}</view>
           <view class="info-content">
             <view class="info-title">{{weather.city}}</view>
             <view class="info-text">{{weather.temperature}}Â°C {{weather.description}}</view>
           </view>
         </view>
       </view>
       
       <!-- ä¸€è¨€å±•ç¤º -->
       <view class="hitokoto-bar">
         <view class="hitokoto-icon">ğŸ’­</view>
         <view class="hitokoto-text">{{hitokoto || 'è·å–ä¸€è¨€ä¸­...'}}</view>
       </view>
       
       <!-- AIä½¿ç”¨æƒ…å†µ -->
       <view class="ai-usage-bar">
         <view class="usage-icon">ğŸ¤–</view>
         <view class="usage-text">ä»Šæ—¥AIå‰©ä½™ {{maxDailyCalls - dailyCallCount}}/{{maxDailyCalls}} æ¬¡</view>
       </view>
     </view>
    
    <!-- æ€§åˆ«åˆ‡æ¢ -->
    <view class="gender-switch">
      <view class="gender-option male {{genderMode === 'male' ? 'active' : ''}}" 
            bindtap="switchGender" data-gender="male">
        ç”·ç”Ÿ
      </view>
      <view class="gender-option female {{genderMode === 'female' ? 'active' : ''}}" 
            bindtap="switchGender" data-gender="female">
        å¥³ç”Ÿ
      </view>
    </view>
  </view>

  <!-- é£æ ¼é€‰æ‹©åŒºåŸŸ -->
  <view class="style-section">
    <view class="section-title">{{genderMode === 'female' ? 'å¥³ç”Ÿé£æ ¼' : 'ç”·ç”Ÿé£æ ¼'}}</view>
    <view class="style-grid">
      <view class="style-btn {{genderMode}} {{(genderMode === 'female' ? selectedFemaleStyle : selectedMaleStyle) === item.name ? 'active' : ''}}" 
            wx:for="{{genderMode === 'female' ? femaleStyles : maleStyles}}" 
            wx:key="key" 
            bindtap="selectStyle" 
            data-style="{{item.name}}">
        <text class="style-text">{{item.name}}</text>
      </view>
    </view>
  </view>

  <!-- è‰²å½©æ­é…é€‰æ‹©åŒºåŸŸ -->
  <view class="color-section">
    <view class="section-title">è‰²å½©æ­é…</view>
    <view class="color-grid">
      <view class="color-btn {{genderMode}} {{selectedColorScheme === item.name ? 'active' : ''}}" 
            wx:for="{{colorSchemes}}" 
            wx:key="key" 
            bindtap="selectColorScheme" 
            data-scheme="{{item.key}}">
        <text class="color-text">{{item.name}}</text>
      </view>
    </view>
  </view>

  <!-- ä¸ªäººåå¥½å¿«é€Ÿæ­é… -->
  <view class="card preference-card" wx:if="{{hasLogin}}">
    <view class="subtitle">ä»Šæ—¥æ¨èæ­é…</view>
    
    <!-- ä¸¤ä¸ªç”ŸæˆæŒ‰é’® -->
    <view class="generate-buttons">
      <view class="generate-btn wardrobe-btn {{wardrobeGenerating ? 'generating' : ''}}" bindtap="generateWithWardrobe">
        <text class="btn-icon">ğŸ‘”</text>
        <text class="btn-text">{{wardrobeGenerating ? 'ç”Ÿæˆä¸­...' : 'æ™ºèƒ½è¡£æ©±æ­é…'}}</text>
        <text class="btn-desc">åŸºäºç°æœ‰è¡£ç‰©æ¨è</text>
      </view>
      
      <view class="generate-btn style-btn {{styleGenerating ? 'generating' : ''}}" bindtap="generateWithStyle">
        <text class="btn-icon">âœ¨</text>
        <text class="btn-text">{{styleGenerating ? 'ç”Ÿæˆä¸­...' : 'æ—¶å°šçµæ„Ÿæ­é…'}}</text>
        <text class="btn-desc">æ¢ç´¢æ–°çš„ç©¿æ­é£æ ¼</text>
      </view>
    </view>
    
    <!-- AIç”Ÿæˆè¿›åº¦æ¡ -->
    <view class="progress-container" wx:if="{{isGenerating}}">
      <view class="progress-title">AIæ­£åœ¨ç”Ÿæˆæ­é…æ–¹æ¡ˆ...</view>
      <view class="progress-bar">
        <view class="progress-fill" style="width: {{progressPercent}}%"></view>
      </view>
      <view class="progress-text">{{progressText}}</view>
    </view>
    
    <!-- éšæœºæ­é…ç»“æœ -->
    <view class="random-outfits" wx:if="{{randomOutfits.length > 0}}">
      <view class="outfit-item" wx:for="{{randomOutfits}}" wx:key="index">
        <view class="outfit-header">
          <view class="outfit-title">æ­é…æ–¹æ¡ˆ {{index + 1}}</view>
          <view class="outfit-actions">
            <view class="action-btn" bindtap="favoriteOutfit" data-index="{{index}}">
              <text class="action-icon">{{item.isFavorite ? 'â¤ï¸' : 'ğŸ¤'}}</text>
              <text class="action-text">{{item.isFavorite ? 'å·²æ”¶è—' : 'æ”¶è—'}}</text>
            </view>
          </view>
          <view class="outfit-weather" wx:if="{{weather}}">
            <text class="weather-tag">{{weather.temperature}}Â°C {{weather.description}}</text>
          </view>
        </view>
        <view class="outfit-content">{{item.outfit}}</view>
        
        <!-- ç©¿æ­å›¾ç‰‡å±•ç¤º -->
        <view class="outfit-images" wx:if="{{item.images && item.images.length > 0}}">
          <view class="images-title">ğŸ“¸ æ­é…å‚è€ƒ</view>
          <scroll-view class="images-scroll" scroll-x="true">
            <view class="image-item" wx:for="{{item.images}}" wx:key="*this" wx:for-item="image">
              <image class="outfit-image" src="{{image.url}}" mode="aspectFill" bindtap="previewImage" data-url="{{image.url}}" data-urls="{{item.images}}" />
              <view class="image-desc">{{image.desc}}</view>
            </view>
          </scroll-view>
        </view>
        
        <view class="outfit-explanation">
          <view class="explanation-section">
            <view class="explanation-title">ğŸ¨ ä¸»è¦é¢œè‰²</view>
            <view class="color-palette">
              <view class="color-item" wx:for="{{item.colors}}" wx:key="*this" wx:for-item="color">
                <view class="color-circle" style="background-color: {{color.hex}}"></view>
                <view class="color-name">{{color.name}}</view>
              </view>
            </view>
          </view>
          <view class="explanation-section">
            <view class="explanation-title">ğŸ’¡ æ­é…ç†ç”±</view>
            <view class="explanation-text">{{item.reason}}</view>
          </view>
          <view class="explanation-section">
            <view class="explanation-title">ğŸ¯ é€‚åˆåœºåˆ</view>
            <view class="explanation-text">{{item.occasion}}</view>
          </view>
        </view>
      </view>
    </view>
  </view>







  <!-- æœªç™»å½•æç¤º -->
  <view class="card login-prompt" wx:if="{{!hasLogin}}">
    <view class="login-text">è¯·å…ˆç™»å½•ä»¥ä½¿ç”¨å®Œæ•´åŠŸèƒ½</view>
    <button class="btn" bindtap="navigateToLogin">ç«‹å³ç™»å½•</button>
  </view>
</view>

<!-- èº«æä¿¡æ¯å¼¹çª— -->
<view class="modal" wx:if="{{showBodyModal}}" bindtap="hideBodyInfoModal">
  <view class="modal-content" catchtap="stopPropagation">
    <view class="modal-title">èº«æä¿¡æ¯</view>
    <view class="input-group">
      <text class="input-label">èº«é«˜ (cm)</text>
      <input class="input" type="number" placeholder="è¯·è¾“å…¥èº«é«˜" 
             value="{{userHeight}}" bindinput="onHeightInput" />
    </view>
    <view class="input-group">
      <text class="input-label">ä½“é‡ (kg)</text>
      <input class="input" type="number" placeholder="è¯·è¾“å…¥ä½“é‡" 
             value="{{userWeight}}" bindinput="onWeightInput" />
    </view>
    <view class="modal-buttons">
      <button class="btn btn-outline" bindtap="hideBodyInfoModal">å–æ¶ˆ</button>
      <button class="btn" bindtap="saveBodyInfo">ä¿å­˜</button>
    </view>
  </view>
</view>